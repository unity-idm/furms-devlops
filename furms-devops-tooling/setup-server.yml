---
- name: Include version vars
  include_vars:
    file: "files/config_templates/{{furmsVersion}}/version_vars.yml"
- name: Check if distribution downloaded
  stat:
    path: "{{distributionFile}}"
  register: distributionFileStatResult
- name: Download distribution
  when: distributionFileStatResult.stat.exists == false
  command: 
    cmd: curl -L {{downloadURL}} --output {{distributionFile}} --silent
    warn: false
- file:
      path: "{{distributionFile}}"
      mode: '0644'
- name: create folder for current installation
  file:
    state: directory
    path: "{{serviceInstallationDir}}"
    mode: '0750'
- name: Extract distribution
  unarchive:
    src: "{{distributionFile}}"
    dest: "{{serviceInstallationDir}}"
    extra_opts: [--strip-components=1]
- name: create symlink
  file:
    state: link
    src: "{{serviceVersionedDir}}"
    dest: "{{serviceCurrentAppDir}}"

